<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMS Emergency Rescue - Follow to Play</title>
    <style>
        /* [MANTIENI TUTTO IL CSS PRECEDENTE] */
        
        /* AGGIUNGI QUESTI STILI */
        .gate-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #dc143c 0%, #003366 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 10000;
            text-align: center;
            padding: 20px;
        }

        .gate-content {
            background: rgba(255,255,255,0.15);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid #ffffff30;
            max-width: 600px;
        }

        .verify-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            margin: 20px 0;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .verify-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .hidden {
            display: none;
        }

        .social-proof {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .social-channel {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
        }
    </style>
</head>
<body>
    <!-- GATE SCREEN -->
    <div id="gateScreen" class="gate-screen">
        <div class="gate-content">
            <h1>üöë EMS EMERGENCY RESCUE</h1>
            <div style="font-size: 2rem; margin: 20px;">üîí FOLLOW TO PLAY</div>
            
            <h2>Step 1: Follow Our Channels</h2>
            <p>To access this FREE medical simulator, please follow our channels:</p>
            
            <div class="social-proof">
                <div class="social-channel">
                    <div style="font-size: 2rem;">üé•</div>
                    <strong>Rumble</strong>
                    <div style="font-size: 0.9rem; opacity: 0.8;">EMS Rescue Games</div>
                </div>
                <div class="social-channel">
                    <div style="font-size: 2rem;">üì±</div>
                    <strong>YouTube</strong>
                    <div style="font-size: 0.9rem; opacity: 0.8;">EMS Emergency Rescue</div>
                </div>
            </div>

            <h3>üìã Requirements:</h3>
            <div style="text-align: left; display: inline-block; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                ‚úÖ Subscribe to our Rumble channel<br>
                ‚úÖ Like the game video<br>
                ‚úÖ Stay subscribed for updates<br>
                ‚úÖ Share with friends who love medical games
            </div>
            
            <button class="verify-btn" onclick="verifySubscription()">
                ‚úÖ I'VE FOLLOWED & LIKED - PLAY NOW!
            </button>
            
            <p style="margin-top: 20px; font-size: 0.9rem; opacity: 0.8;">
                üîí Game unlocks after verification | üí∞ 100% FREE forever
            </p>

            <div style="margin-top: 20px; font-size: 0.8rem; opacity: 0.6;">
                Having issues? Contact us with screenshot proof of subscription
            </div>
        </div>
    </div>

    <!-- MAIN GAME (nascosto inizialmente) -->
    <div id="gameContainer" class="hidden">
        <!-- [INCCOLLA QUI TUTTO IL CODICE DEL GIOCO CHE ABBIAMO] -->
    </div>

    <script>
        // ==================== FOLLOW TO PLAY SYSTEM ====================
        let isVerified = false;

        function checkInitialVerification() {
            const saved = localStorage.getItem('emsGameVerified');
            if (saved === 'true') {
                unlockGame();
            }
        }

        function verifySubscription() {
            // Sistema a "onore" - poi possiamo migliorare
            const userConfirmed = confirm("Have you really subscribed to our Rumble channel and liked the video?\n\nWe work hard to create free educational games. Your support helps us continue!");
            
            if (userConfirmed) {
                // Salva la verifica per 30 giorni
                localStorage.setItem('emsGameVerified', 'true');
                const expiry = new Date();
                expiry.setDate(expiry.getDate() + 30);
                localStorage.setItem('emsGameExpiry', expiry.toISOString());
                
                unlockGame();
                showMessage("üéâ Thank you for your support! Enjoy the game!", "success");
            } else {
                alert("Please subscribe to our channels to access the game. It helps us create more free medical games!");
            }
        }

        function unlockGame() {
            document.getElementById('gateScreen').classList.add('hidden');
            document.getElementById('gameContainer').classList.remove('hidden');
            isVerified = true;
            
            // Avvia il gioco se non √® gi√† iniziato
            if (typeof initGame === 'function' && !window.gameInitialized) {
                initGame();
                window.gameInitialized = true;
            }
        }

        function checkVerificationExpiry() {
            const expiry = localStorage.getItem('emsGameExpiry');
            if (expiry && new Date() > new Date(expiry)) {
                localStorage.removeItem('emsGameVerified');
                localStorage.removeItem('emsGameExpiry');
                location.reload();
            }
        }

        // ==================== NUOVE EMERGENZE MEDICHE ====================
        const newEmergencies = [
            {
                name: "DIABETIC EMERGENCY",
                symptom: "ü•¥ Confusion, sweating, tremors - low blood sugar",
                correctTool: "glucose_gel",
                tools: ["glucose_gel", "insulin", "defibrillator", "oxygen_mask"],
                educational: "For hypoglycemia, give fast-acting sugar. For hyperglycemia, seek immediate medical help."
            },
            {
                name: "SEIZURE",
                symptom: "‚ö° Uncontrolled shaking, loss of consciousness",
                correctTool: "recovery_position",
                tools: ["recovery_position", "defibrillator", "neck_brace", "oxygen_mask"],
                educational: "Never put anything in mouth during seizure. Place in recovery position after it stops."
            },
            {
                name: "ALLERGIC REACTION",
                symptom: "üå°Ô∏è Hives, itching, mild swelling after food",
                correctTool: "antihistamine",
                tools: ["antihistamine", "epipen", "oxygen_mask", "iv_bag"],
                educational: "Antihistamines for mild reactions, EpiPen for anaphylaxis with breathing difficulty."
            },
            {
                name: "HEAT STROKE",
                symptom: "üî• High body temperature, confusion, no sweating",
                correctTool: "cooling_blanket",
                tools: ["cooling_blanket", "iv_bag", "oxygen_mask", "defibrillator"],
                educational: "Cool patient rapidly and provide fluids. Heat stroke is a medical emergency."
            },
            {
                name: "OVERDOSE",
                symptom: "üíä Slow breathing, pinpoint pupils, unconscious",
                correctTool: "naloxone",
                tools: ["naloxone", "oxygen_mask", "iv_bag", "defibrillator"],
                educational: "Naloxone can reverse opioid overdose. Always call EMS for overdose cases."
            }
        ];

        // Aggiungi questi nuovi strumenti
        const newTools = {
            glucose_gel: { name: "Glucose Gel", emoji: "üçØ" },
            insulin: { name: "Insulin", emoji: "üíä" },
            recovery_position: { name: "Recovery Position", emoji: "üîÑ" },
            antihistamine: { name: "Antihistamine", emoji: "üíä" },
            cooling_blanket: { name: "Cooling Blanket", emoji: "‚ùÑÔ∏è" },
            naloxone: { name: "Naloxone", emoji: "üíâ" }
        };

        // ==================== INIZIALIZZAZIONE ====================
        document.addEventListener('DOMContentLoaded', function() {
            checkVerificationExpiry();
            checkInitialVerification();
            
            // Unisci le emergenze esistenti con le nuove
            if (typeof emergencies !== 'undefined') {
                emergencies.push(...newEmergencies);
            }
            
            // Unisci gli strumenti
            if (typeof toolsData !== 'undefined') {
                Object.assign(toolsData, newTools);
            }
        });

        // [MANTIENI TUTTO IL RESTO DEL CODICE DEL GIOCO]
    </script>
</body>
</html>
